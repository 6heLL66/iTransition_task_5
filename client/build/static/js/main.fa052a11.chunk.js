(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{102:function(t,e,a){"use strict";a.r(e);var s=a(0),n=a(1),i=a.n(n),c=a(53),r=a.n(c),o=(a(62),a(55)),l=a(2),h=a(20),d=a.n(h),u=a(32),m=a(7),p=a(8),j=a(10),b=a(9),f=(a(35),function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){var s;return Object(m.a)(this,a),(s=e.call(this,t)).state={games:[],findedGames:[],modal:"modal fade"},s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.updateGames(),localStorage.getItem("id")||localStorage.setItem("id","f".concat((+new Date).toString(16)))}},{key:"getName",value:function(t){return this.state.games[t].props.name}},{key:"updateGames",value:function(){var t=Object(u.a)(d.a.mark((function t(){var e,a,n=this;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/getGames",{method:"POST"});case 2:return e=t.sent,t.next=5,e.json();case 5:a=t.sent,this.state.games=[],this.state.findedGames=[],a.map((function(t,e){n.state.games.push(Object(s.jsx)(x,{getName:n.getName.bind(n),name:t.name,players:t.playersCount,number:e+1,status:t.status,tags:t.tags},e)),n.state.findedGames.push(n.state.games[e])})),this.forceUpdate();case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"showModal",value:function(){this.setState({modal:"modal fade show"})}},{key:"hideModal",value:function(){this.setState({modal:"modal fade"})}},{key:"hideGames",value:function(t){this.setState({findedGames:t})}},{key:"clearCookie",value:function(){localStorage.clear()}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)(v,{games:this.state.games,func:this.hideGames.bind(this),flag:"findTags"}),Object(s.jsxs)("table",{className:"table table-dark table-striped",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{scope:"col",children:"#"}),Object(s.jsx)("th",{scope:"col",children:"Name"}),Object(s.jsx)("th",{scope:"col",children:"Players"}),Object(s.jsx)("th",{scope:"col",children:"Status"})]})}),Object(s.jsx)("tbody",{children:this.state.findedGames})]}),Object(s.jsx)("div",{className:"form-row text-center",children:Object(s.jsx)("button",{className:"btn btn-outline-success",onClick:this.showModal.bind(this),children:"+Create New Game"})}),Object(s.jsx)(O,{fade:this.state.modal,hide:this.hideModal.bind(this)})]})}}]),a}(i.a.Component)),x=function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){return Object(m.a)(this,a),e.call(this,t)}return Object(p.a)(a,[{key:"connectToGame",value:function(t){window.location.href="/game/"+this.props.getName(this.props.number-1)}},{key:"render",value:function(){return Object(s.jsxs)("tr",{style:{cursor:"pointer"},onClick:this.connectToGame.bind(this),children:[Object(s.jsx)("th",{scope:"row",children:this.props.number}),Object(s.jsx)("td",{children:this.props.name}),Object(s.jsx)("td",{children:this.props.players+"/2"}),Object(s.jsx)("td",{children:this.props.status})]})}}]),a}(i.a.Component),v=function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){return Object(m.a)(this,a),e.call(this,t)}return Object(p.a)(a,[{key:"find",value:function(t){var e=t.target.value.split(" ");if("findTags"===this.props.flag){for(var a=[],s=this.props.games,n=0;n<s.length;n++){for(var i=!1,c=0;c<s[n].props.tags.length;c++)for(var r=0;r<e.length;r++)e[r]===s[n].props.tags[c]&&(i=!0);i&&a.push(s[n])}""===t.target.value?this.props.func(s):this.props.func(a)}else"setTags"===this.props.flag&&this.props.func(e)}},{key:"render",value:function(){return Object(s.jsx)("input",{className:"form-control mb-2 mt-2",style:{width:"30%",minWidth:"120px"},placeholder:"Type tags...",autocomplete:"on",onInput:this.find.bind(this)})}}]),a}(i.a.Component),O=function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){var s;return Object(m.a)(this,a),(s=e.call(this,t)).state={name:"",tags:[]},s}return Object(p.a)(a,[{key:"changeHandler",value:function(t){this.state.name=t.target.value}},{key:"updateTags",value:function(t){this.setState({tags:t})}},{key:"createGame",value:function(){var t=Object(u.a)(d.a.mark((function t(){var e,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={name:this.state.name,playersCount:"0",players:{x:"",o:""},score:[0,0],status:"waiting",turn:"x",state:[["-","-","-"],["-","-","-"],["-","-","-"]],continue:[],tags:this.state.tags},t.next=3,fetch("/api/createGame",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 3:return a=t.sent,t.t0=console,t.next=7,a.json();case 7:t.t1=t.sent,t.t0.log.call(t.t0,t.t1),window.location.href="/game/"+e.name;case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return Object(s.jsx)("div",{className:this.props.fade,id:"exampleModal",style:{display:"modal fade"===this.props.fade?"none":"block"},children:Object(s.jsx)("div",{className:"modal-dialog",children:Object(s.jsxs)("div",{className:"modal-content",children:[Object(s.jsxs)("div",{className:"modal-header",children:[Object(s.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Create New Game"}),Object(s.jsx)("button",{className:"btn-close","aria-label":"Close",onClick:this.props.hide})]}),Object(s.jsxs)("div",{className:"modal-body",children:[Object(s.jsx)("label",{children:"Name:"}),Object(s.jsx)("input",{type:"text",className:"form-control",placeholder:"game's name",onInput:this.changeHandler.bind(this)}),Object(s.jsx)(v,{games:[],func:this.updateTags.bind(this),flag:"setTags"})]}),Object(s.jsx)("div",{className:"form-row text-center",children:Object(s.jsx)("button",{className:"btn btn-primary mb-2",onClick:this.createGame.bind(this),children:"Create Game"})})]})})})}}]),a}(i.a.Component),g=f,y=a(54),w=a.n(y),k=(a(97),w()()),N=function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){var s;return Object(m.a)(this,a),(s=e.call(this,t)).state={state:[["-","-","-"],["-","-","-"],["-","-","-"]],playersCount:0,turn:"x",winner:"no",status:"waiting",modal:"modal fade",team:"",room:window.location.href.split("/")[4],score:[0,0],players:{x:"",y:""}},s}return Object(p.a)(a,[{key:"showWin",value:function(t){this.setState({winner:t.team,modal:"modal fade show"})}},{key:"componentDidMount",value:function(){var t=this;k.on("redirectOnMain",(function(){return window.location.href="/"})),k.emit("connectPlayer",{room:this.state.room,id:localStorage.getItem("id")}),k.on("updateClient",(function(e){t.setState({state:e.state,turn:e.turn,status:e.status,playersCount:e.playersCount,players:e.players,score:e.score,team:e.players.x===localStorage.getItem("id")?"x":"o",modal:"modal fade",winner:"no"});var a=t.checkWin();a&&t.showWin(a)})),k.on("setCookie",(function(t){fetch("/api/setCookie",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}))}},{key:"checkWin",value:function(){var t,e=this.state.state,a=!0;return e[0].map((function(s,n){"-"===s||"-"===e[1][n]||"-"===e[2][n]?a=!1:s===e[1][n]&&s===e[2][n]&&(t={win:[[0,n],[1,n],[2,n]],team:s})})),e.map((function(e,s){"-"===e[0]||"-"===e[1]||"-"===e[2]?a=!1:e[0]===e[1]&&e[0]===e[2]&&(t={win:[[s,0],[s,1],[s,2]],team:e[0]})})),a?{team:"draw"}:e[0][0]===e[1][1]&&e[1][1]===e[2][2]&&"-"!=e[0][0]?{win:[[0,0],[1,1],[2,2]],team:e[0][0]}:e[0][2]===e[1][1]&&e[1][1]===e[2][0]&&"-"!=e[0][2]?{win:[[0,2],[1,1],[2,0]],team:e[0][2]}:t||!1}},{key:"set",value:function(t,e){"-"===this.state.state[e][t]&&this.state.turn===this.state.team&&(this.state.state[e][t]=this.state.team,this.state.turn="x"===this.state.turn?"o":"x",k.emit("updateGame",{prop:"state",value:this.state.state,room:this.state.room}),k.emit("updateGame",{prop:"turn",value:this.state.turn,room:this.state.room}))}},{key:"render",value:function(){return Object(s.jsxs)(i.a.Fragment,{children:[Object(s.jsx)(C,{turn:this.state.turn,team:this.state.team,status:this.state.status,score:this.state.score}),Object(s.jsx)(S,{state:this.state.state,set:this.set.bind(this),modal:this.state.modal,winner:this.state.winner,status:this.state.status})]})}}]),a}(i.a.Component),C=function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){return Object(m.a)(this,a),e.call(this,t)}return Object(p.a)(a,[{key:"render",value:function(){return Object(s.jsxs)("div",{className:"info",children:[Object(s.jsx)("div",{className:"team",children:"YOUR TEAM: "+this.props.team}),Object(s.jsx)("div",{className:"status",style:{color:"waiting"===this.props.status?"yellow":"green"},children:this.props.status}),Object(s.jsx)("div",{className:"score",children:"X: "+String(this.props.score[0])+" : "+String(this.props.score[1])+" :O"}),Object(s.jsx)("div",{className:"turn",style:{color:"x"===this.props.turn?"red":"blue"},children:"TURN: "+this.props.turn})]})}}]),a}(i.a.Component),S=function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){var s;return Object(m.a)(this,a),(s=e.call(this,t)).state={canvas:null},s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var t=document.getElementById("canvas");t.width=t.parentNode.offsetWidth,t.height=t.width,this.state.canvas=t,this.state.ctx=t.getContext("2d"),this.drawBoard()}},{key:"drawBoard",value:function(){var t=this.state.canvas.width;this.state.ctx.fillStyle="black",this.state.ctx.fillRect(t/3,0,2,t),this.state.ctx.fillRect(2*t/3,0,2,t),this.state.ctx.fillRect(0,t/3,t,2),this.state.ctx.fillRect(0,2*t/3,t,2)}},{key:"componentDidUpdate",value:function(){this.drawState()}},{key:"drawZero",value:function(t,e){var a=this.state.canvas.width;this.state.ctx.strokeStyle="blue",this.state.ctx.lineWidth=4,this.state.ctx.beginPath(),this.state.ctx.arc(t*a/3+a/6,e*a/3+a/6,a/6-a/24,0,2*Math.PI),this.state.ctx.stroke()}},{key:"drawCross",value:function(t,e){var a=this.state.canvas.width;this.state.ctx.strokeStyle="red",this.state.ctx.lineWidth=4,this.state.ctx.beginPath(),this.state.ctx.moveTo(t*a/3+a/24,e*a/3+a/24),this.state.ctx.lineTo(t*a/3+a/3-a/24,e*a/3+a/3-a/24),this.state.ctx.moveTo(t*a/3+a/3-a/24,e*a/3+a/24),this.state.ctx.lineTo(t*a/3+a/24,e*a/3+a/3-a/24),this.state.ctx.stroke()}},{key:"clearBoard",value:function(){this.state.canvas.width=this.state.canvas.width}},{key:"drawState",value:function(){var t=this;this.clearBoard(),this.drawBoard(),this.props.state.map((function(e,a){for(var s=0;s<e.length;s++)"-"!=e[s]&&("x"==e[s]?t.drawCross(s,a):"o"==e[s]&&t.drawZero(s,a))}))}},{key:"makeStep",value:function(t){var e=this.state.canvas.offsetWidth,a=t.clientX-t.target.offsetLeft,s=t.clientY-t.target.offsetTop;a=a>=0&&a<=e/3?0:a>e/3&&a<=2*e/3?1:2,s=s>=0&&s<=e/3?0:s>e/3&&s<=2*e/3?1:2,"no"===this.props.winner&&"waiting"!==this.props.status&&this.props.set(a,s)}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"container text-center",children:[Object(s.jsx)("canvas",{id:"canvas",onClick:this.makeStep.bind(this)}),Object(s.jsx)(G,{winner:this.props.winner,fade:this.props.modal})]})}}]),a}(i.a.Component),G=function(t){Object(j.a)(a,t);var e=Object(b.a)(a);function a(t){return Object(m.a)(this,a),e.call(this,t)}return Object(p.a)(a,[{key:"end",value:function(){k.emit("deleteGame",window.location.href.split("/")[4])}},{key:"continue",value:function(){k.emit("addContinue",{room:window.location.href.split("/")[4],id:localStorage.getItem("id"),winner:this.props.winner})}},{key:"render",value:function(){return Object(s.jsx)("div",{className:this.props.fade,id:"exampleModal",style:{display:"modal fade"===this.props.fade?"none":"block"},children:Object(s.jsx)("div",{className:"modal-dialog",children:Object(s.jsxs)("div",{className:"modal-content",children:[Object(s.jsx)("div",{className:"modal-header",children:Object(s.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Game Info"})}),Object(s.jsx)("div",{className:"modal-body",children:Object(s.jsxs)("div",{children:["Winner: ",this.props.winner.toUpperCase()]})}),Object(s.jsxs)("div",{className:"form-row text-center",children:[Object(s.jsx)("button",{className:"btn btn-success mb-2",onClick:this.continue.bind(this),children:"Continue Game"}),Object(s.jsx)("button",{className:"btn btn-danger mb-2 ml-5",onClick:this.end.bind(this),children:"End Game"})]})]})})})}}]),a}(i.a.Component),T=N;var M=function(){return Object(s.jsx)(o.a,{children:Object(s.jsxs)(l.d,{children:[Object(s.jsx)(l.b,{path:"/",exact:!0,children:Object(s.jsx)(g,{})}),Object(s.jsx)(l.b,{path:"/game/:id",exact:!0,children:Object(s.jsx)(T,{})}),Object(s.jsx)(l.a,{to:"/"})]})})};r.a.render(Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(M,{})}),document.getElementById("root"))},35:function(t,e,a){},62:function(t,e,a){},97:function(t,e,a){}},[[102,1,2]]]);
//# sourceMappingURL=main.fa052a11.chunk.js.map